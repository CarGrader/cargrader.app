<!-- cargrader.app/templates/_header.html -->
<header class="site-header">
  <nav class="site-nav">
    <!-- Left: Menu -->
    <div class="nav-left">
      <button class="btn header-btn" id="menuBtn" type="button" aria-expanded="false" aria-controls="menuPanel">
        Menu
      </button>
      <div class="menu-panel" id="menuPanel" role="menu" aria-hidden="true">
        <a class="menu-item" href="/" role="menuitem">Home</a>
        <a class="menu-item" href="{{ url_for('billing.account') }}" role="menuitem">Account</a>
        <a class="menu-item" href="{{ url_for('billing.store') }}" role="menuitem">Store</a>
        <a class="menu-item" href="{{ url_for('pages.about') }}" role="menuitem">About</a>
      </div>
    </div>

    <!-- Center: (intentionally empty spacerâ€”no logo) -->
    <div class="nav-center"></div>

    <!-- Right: Auth -->
    <div class="nav-right">
      {% if session.get('user') %}
        <a class="btn header-btn" href="{{ url_for('auth.logout') }}">Logout</a>
      {% else %}
        <a class="btn header-btn" href="{{ url_for('auth.login') }}">Create Account / Login</a>
      {% endif %}
    </div>
  </nav>

  <script>
    (function(){
      const btn   = document.getElementById('menuBtn');
      const panel = document.getElementById('menuPanel');

      function openPanel() {
        panel.classList.add('open');
        panel.setAttribute('aria-hidden', 'false');
        btn.setAttribute('aria-expanded', 'true');
        document.addEventListener('click', onDocClick, true);
        document.addEventListener('keydown', onKey, true);
      }
      function closePanel() {
        panel.classList.remove('open');
        panel.setAttribute('aria-hidden', 'true');
        btn.setAttribute('aria-expanded', 'false');
        document.removeEventListener('click', onDocClick, true);
        document.removeEventListener('keydown', onKey, true);
      }
      function togglePanel() {
        if (panel.classList.contains('open')) closePanel(); else openPanel();
      }
      function onDocClick(e) {
        if (!panel.contains(e.target) && e.target !== btn) closePanel();
      }
      function onKey(e) { if (e.key === 'Escape') closePanel(); }

      btn?.addEventListener('click', function(e){
        e.preventDefault(); // make sure it never submits anything
        togglePanel();
      });
    })();
  </script>
</header>
