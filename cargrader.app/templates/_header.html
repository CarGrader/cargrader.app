<!-- cargrader.app/templates/_header.html -->
<header class="site-header">
  <nav class="site-nav">
    <!-- Left: Menu -->
    <div class="left">
      <button id="menu-btn" class="btn header-btn" type="button" aria-expanded="false" aria-controls="menu-panel">
        <!-- optional hamburger icon -->
        <svg aria-hidden="true" width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
          <path d="M4 6h16M4 12h16M4 18h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span>Menu</span>
      </button>
    </div>


    <!-- Center: (intentionally empty spacerâ€”no logo) -->
    <div class="nav-center"></div>

    <!-- Right: Auth (Login or Logout) -->
    <div class="nav-right">
      {% if session.user %}
        <a class="nav-btn" href="{{ url_for('auth.logout') }}">Logout</a>
      {% else %}
        <a class="nav-btn" href="{{ url_for('auth.login') }}">Create Account / Login</a>
      {% endif %}
    </div>
  </nav>

  <script>
    (function(){
      const btn   = document.getElementById('menuBtn');
      const panel = document.getElementById('menuPanel');

      function openPanel() {
        panel.classList.add('open');
        panel.setAttribute('aria-hidden', 'false');
        btn.setAttribute('aria-expanded', 'true');
        document.addEventListener('click', onDocClick, true);
        document.addEventListener('keydown', onKey, true);
      }
      function closePanel() {
        panel.classList.remove('open');
        panel.setAttribute('aria-hidden', 'true');
        btn.setAttribute('aria-expanded', 'false');
        document.removeEventListener('click', onDocClick, true);
        document.removeEventListener('keydown', onKey, true);
      }
      function togglePanel() {
        if (panel.classList.contains('open')) closePanel(); else openPanel();
      }
      function onDocClick(e) {
        if (!panel.contains(e.target) && e.target !== btn) closePanel();
      }
      function onKey(e) { if (e.key === 'Escape') closePanel(); }

      btn?.addEventListener('click', function(e){
        e.preventDefault(); // make sure it never submits anything
        togglePanel();
      });
    })();
  </script>
</header>
